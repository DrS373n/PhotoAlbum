<Window
    x:Class="PhotoAlbum.App.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <MenuBar Grid.Row="0" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}">
            <MenuBarItem Title="File">
                <MenuFlyoutItem Text="New Project" Command="{x:Bind ViewModel.CreateNewProjectCommand}">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="N"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
                <MenuFlyoutItem Text="Open Project">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="O"/>
                    </KeyboardAccelerator>
                </MenuFlyoutItem>
                <MenuFlyoutItem Text="Save Project" Command="{x:Bind ViewModel.SaveProjectCommand}">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="S"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
                <MenuFlyoutSeparator/>
                <MenuFlyoutItem Text="Import Photos" Command="{x:Bind ViewModel.ImportPhotosCommand}">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="I"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
                <MenuFlyoutSeparator/>
                <MenuFlyoutItem Text="Export to PDF"/>
                <MenuFlyoutSeparator/>
                <MenuFlyoutItem Text="Exit"/>
            </MenuBarItem>
            
            <MenuBarItem Title="Edit">
                <MenuFlyoutItem Text="Undo">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="Z"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
                <MenuFlyoutItem Text="Redo">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="Y"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
            </MenuBarItem>
            
            <MenuBarItem Title="Pages">
                <MenuFlyoutItem Text="Add Spread" Command="{x:Bind ViewModel.AddSpreadCommand}"/>
                <MenuFlyoutItem Text="Delete Spread"/>
                <MenuFlyoutSeparator/>
                <MenuFlyoutItem Text="Duplicate Spread"/>
            </MenuBarItem>
            
            <MenuBarItem Title="Design">
                <MenuFlyoutItem Text="Auto Design"/>
                <MenuFlyoutItem Text="Apply Template"/>
                <MenuFlyoutSeparator/>
                <MenuFlyoutItem Text="Add Text"/>
                <MenuFlyoutItem Text="Add Background"/>
            </MenuBarItem>
            
            <MenuBarItem Title="View">
                <MenuFlyoutItem Text="Show Planner View"/>
                <MenuFlyoutItem Text="Show Image Well"/>
                <MenuFlyoutSeparator/>
                <MenuFlyoutItem Text="Show Cut Lines"/>
                <MenuFlyoutItem Text="Show Safe Zones"/>
            </MenuBarItem>
            
            <MenuBarItem Title="Help">
                <MenuFlyoutItem Text="Documentation"/>
                <MenuFlyoutItem Text="About"/>
            </MenuBarItem>
        </MenuBar>

        <!-- Toolbar -->
        <CommandBar Grid.Row="1" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}">
            <AppBarButton Icon="Add" Label="New" Command="{x:Bind ViewModel.CreateNewProjectCommand}"/>
            <AppBarButton Icon="OpenFile" Label="Open"/>
            <AppBarButton Icon="Save" Label="Save" Command="{x:Bind ViewModel.SaveProjectCommand}"/>
            <AppBarSeparator/>
            <AppBarButton Icon="Import" Label="Import" Command="{x:Bind ViewModel.ImportPhotosCommand}"/>
            <AppBarSeparator/>
            <AppBarButton Icon="Undo" Label="Undo"/>
            <AppBarButton Icon="Redo" Label="Redo"/>
            <AppBarSeparator/>
            <AppBarButton Label="Zoom In" Command="{x:Bind ViewModel.DesignCanvas.ZoomInCommand}">
                <AppBarButton.Icon>
                    <FontIcon Glyph="&#xE8A3;"/>
                </AppBarButton.Icon>
            </AppBarButton>
            <AppBarButton Label="Zoom Out" Command="{x:Bind ViewModel.DesignCanvas.ZoomOutCommand}">
                <AppBarButton.Icon>
                    <FontIcon Glyph="&#xE71E;"/>
                </AppBarButton.Icon>
            </AppBarButton>
            <AppBarButton Label="Fit" Command="{x:Bind ViewModel.DesignCanvas.ZoomFitCommand}">
                <AppBarButton.Icon>
                    <FontIcon Glyph="&#xE740;"/>
                </AppBarButton.Icon>
            </AppBarButton>
        </CommandBar>

        <!-- Main Content Area -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel - Image Well -->
            <Grid Grid.Column="0" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}" 
                  BorderBrush="{ThemeResource SystemControlForegroundBaseMediumLowBrush}" 
                  BorderThickness="0,0,1,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Image Well" FontSize="16" FontWeight="SemiBold" 
                           Margin="12,12,12,8"/>

                <StackPanel Grid.Row="1" Margin="12,0,12,12">
                    <TextBox PlaceholderText="Search photos..." 
                             Text="{x:Bind ViewModel.ImageWell.SearchText, Mode=TwoWay}"/>
                    <ComboBox Header="Filter" Margin="0,8,0,0" HorizontalAlignment="Stretch"
                              ItemsSource="{x:Bind ViewModel.ImageWell.GroupFilters}"
                              SelectedItem="{x:Bind ViewModel.ImageWell.SelectedGroupFilter, Mode=TwoWay}"/>
                </StackPanel>

                <ScrollViewer Grid.Row="2">
                    <ItemsControl ItemsSource="{x:Bind ViewModel.ImageWell.FilteredPhotos, Mode=OneWay}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsWrapGrid Orientation="Horizontal" MaximumRowsOrColumns="2"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="4" BorderBrush="Gray" BorderThickness="1" 
                                        Background="White" CornerRadius="4">
                                    <StackPanel>
                                        <Image Height="100" Width="100" Stretch="UniformToFill">
                                            <!-- Would bind to thumbnail -->
                                        </Image>
                                        <TextBlock Text="{Binding FileName}" FontSize="10" 
                                                   TextTrimming="CharacterEllipsis" 
                                                   Margin="4,2" TextAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>

            <!-- Center Panel - Design Canvas -->
            <Grid Grid.Column="1" Background="{StaticResource CanvasBackgroundBrush}">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" 
                              VerticalScrollBarVisibility="Auto"
                              ZoomMode="Enabled">
                    <Viewbox Stretch="Uniform" Margin="20">
                        <Grid Width="1200" Height="1200" Background="White">
                            <!-- Design Canvas Content -->
                            <TextBlock Text="Design Canvas" 
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center" 
                                       FontSize="24" 
                                       Opacity="0.3"/>
                            
                            <Border BorderBrush="Red" BorderThickness="2" 
                                    Margin="15" Opacity="0.3"
                                    Visibility="{x:Bind ViewModel.DesignCanvas.ShowCutLines, Mode=OneWay}"/>
                            
                            <Border BorderBrush="Blue" BorderThickness="1" 
                                    Margin="30" Opacity="0.3"
                                    Visibility="{x:Bind ViewModel.DesignCanvas.ShowSafeZones, Mode=OneWay}"/>
                        </Grid>
                    </Viewbox>
                </ScrollViewer>

                <!-- Canvas Overlay Info -->
                <StackPanel HorizontalAlignment="Right" VerticalAlignment="Bottom" 
                            Margin="20" Background="#80000000" Padding="8">
                    <TextBlock Text="{x:Bind ViewModel.DesignCanvas.ZoomLevel, Mode=OneWay}" 
                               Foreground="White"/>
                </StackPanel>
            </Grid>

            <!-- Right Panel - Properties & Templates -->
            <Grid Grid.Column="2" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}"
                  BorderBrush="{ThemeResource SystemControlForegroundBaseMediumLowBrush}"
                  BorderThickness="1,0,0,0">
                <TabView>
                    <TabViewItem Header="Templates">
                        <ScrollViewer>
                            <StackPanel Margin="12">
                                <TextBlock Text="Quick Design Picker" FontWeight="SemiBold" 
                                           Margin="0,0,0,8"/>
                                
                                <ItemsControl ItemsSource="{x:Bind ViewModel.DesignCanvas.AvailableTemplates, Mode=OneWay}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Button Margin="0,4" HorizontalAlignment="Stretch" 
                                                    HorizontalContentAlignment="Left">
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                                                    <TextBlock Text="{Binding Category}" FontSize="12" 
                                                               Opacity="0.7"/>
                                                </StackPanel>
                                            </Button>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </ScrollViewer>
                    </TabViewItem>
                    
                    <TabViewItem Header="Properties">
                        <ScrollViewer>
                            <StackPanel Margin="12">
                                <TextBlock Text="Page Properties" FontWeight="SemiBold" 
                                           Margin="0,0,0,8"/>
                                <TextBlock Text="No selection" Opacity="0.7"/>
                            </StackPanel>
                        </ScrollViewer>
                    </TabViewItem>
                    
                    <TabViewItem Header="Planner">
                        <ScrollViewer>
                            <ItemsControl ItemsSource="{x:Bind ViewModel.Planner.Spreads, Mode=OneWay}" 
                                          Margin="12">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Margin="0,4" BorderBrush="Gray" BorderThickness="1" 
                                                Background="White" CornerRadius="4" Height="60">
                                            <Grid>
                                                <TextBlock Text="{Binding SpreadNumber}" 
                                                           HorizontalAlignment="Center" 
                                                           VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </TabViewItem>
                </TabView>
            </Grid>
        </Grid>

        <!-- Status Bar -->
        <Grid Grid.Row="3" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}" 
              BorderBrush="{ThemeResource SystemControlForegroundBaseMediumLowBrush}" 
              BorderThickness="0,1,0,0" Height="28">
            <TextBlock Text="{x:Bind ViewModel.StatusMessage, Mode=OneWay}" 
                       Margin="12,0" VerticalAlignment="Center" FontSize="12"/>
        </Grid>
    </Grid>
</Window>
